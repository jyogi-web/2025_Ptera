FROM golang:1.25-alpine

ENV ROOT=/go/src/app
ENV CGO_ENABLED=0
WORKDIR ${ROOT}

RUN apk update && apk add --no-cache git make

# Airをインストール (ホットリロード用)
RUN go install github.com/air-verse/air@latest

COPY go.mod go.sum ./
RUN go mod download

EXPOSE 50051

# 開発環境ではAirを使ってホットリロード
CMD ["air", "-c", ".air.toml"]
